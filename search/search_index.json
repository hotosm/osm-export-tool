{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Export Tool","text":"<p>The Export Tool is a web service that generates exports of OpenStreetMap (OSM) data for use in Geographic Information System (GIS) programs and mobile devices. The tool allows users to define an area of interest using a polygon and select OSM tags to include in the export. The tool then generates tabular files in various formats, such as CSV or GeoJSON, containing the OSM data within the specified area and tags.</p> <p>One of the most important features of the Export Tool is its synchronization with the main OSM database. The tool is updated minutely, which means that it reflects changes made to the OSM database in near-real time. This makes the Export Tool a valuable resource for humanitarian mapping efforts that require up-to-date OSM data.</p> <p>In addition to creating GIS files, the Export Tool also includes features such as periodic exports for humanitarian organizations and email notifications for when exports are complete. The tool also includes a user-friendly interface with error reporting and geometry drawing/uploading, built on OpenLayers.</p> <p></p>"},{"location":"#get-involved","title":"Get involved!","text":"<p>This is the source code for the web service available at export.hotosm.org. If you would like to export OSM data offline without using the website, you can access the separate command line tool and Python Library. This repository is at github.com/osm-export-tool-python. </p>"},{"location":"#product-roadmap","title":"Product Roadmap","text":"Status Feature \u2705 Connection with raw-data-api \u2705 Vector tile support \u2705 Stable Country exports support \u2705 Upgrade python and django version \u2705 Admin methods to control queues and manage exports \u2705 Migration of cloud env \u2699\ufe0f Connect HDX exports with custom yaml endpoint in raw-data-api Upgrade Frontend of export tool ( Ideation )"},{"location":"#how-to-contribute","title":"How to Contribute","text":"<ul> <li>To report a problem or bug, please include a link to the export's download page. This will be a URL that looks like this: export.hotosm.org/en/v3/exports/cb709d41-6f78-4ee5-8e9a-9eae7b63177c</li> <li>Include the GIS program you are using and the version: for example, QGIS 3.8.</li> <li>Screenshots of the web interface or the data within your GIS program are always helpful!</li> <li>See detailed contributor guidelines here.</li> </ul>"},{"location":"#for-developers","title":"For Developers","text":"<p>The code in this repository powers the export tool web service and includes a number of features besides creating GIS files:</p> <ul> <li>Periodic exports for HOT's partner humanitarian organizations, such as those that appear on the Humanitarian Data Exchange platform.</li> <li>Authentication via OSM accounts and email notifications for when exports are complete.</li> <li>Storage of YAML feature tag selections.</li> <li>A rich user interface with error reporting and geometry drawing/uploading, built on OpenLayers.</li> </ul> <p>If you would like to host the Export Tool yourself, see the <code>ops</code> folder, which includes instructions for setting up both an Overpass Instance and the Export tool web app on Ubuntu. </p> <p>If you would like to enhance the code of the Export Tool web app, a guide to installing it in a local development environment is at docs/setup-development.md.</p>"},{"location":"CODE_OF_CONDUCT/","title":"Code of conduct","text":"<p>(The latest version can be found at https://www.hotosm.org/code-of-conduct)</p> <p>Welcome to Humanitarian OpenStreetMap Team. HOT is committed to providing a welcoming and safe environment for people of all races, gender identities, gender expressions, sexual orientations, physical abilities, physical appearances, socio-economic backgrounds, nationalities, ages, religions, and beliefs.</p> <p>The HOT community principles are:</p> <p>Be friendly and patient. Be generous and kind in both giving and accepting critique. Critique is a natural and important part of our culture. Good critiques are kind, respectful, clear, and constructive, focused on goals and requirements rather than personal preferences. You are expected to give and receive criticism with grace. Be considerate in speech and actions, and actively seek to acknowledge and respect the boundaries of fellow attendees.</p> <p>Be welcoming. We strive to be a community that welcomes and supports people of all backgrounds and identities. Some examples of behavior that contributes to creating a positive environment include:</p> <ul> <li> <p>Using welcoming and inclusive language.</p> </li> <li> <p>Being respectful of differing viewpoints and experiences.</p> </li> <li> <p>Gracefully accepting constructive criticism.</p> </li> <li> <p>Showing empathy towards other community members.</p> </li> <li> <p>Placing collective interest before your own interest.</p> </li> </ul> <p>Be considerate. Your work will be used by other people, and you in turn will depend on the work of others. Any decision you take will affect users and colleagues, and you should take those consequences into account when making decisions. Remember that we're a world-wide community, so you might not be communicating in someone else's primary language.</p> <p>Be respectful. Not all of us will agree all the time, but disagreement is no excuse for poor behavior and poor manners. We might all experience some frustration now and then, but we cannot allow that frustration to turn into a personal attack. It\u2019s important to remember that a community where people feel uncomfortable or threatened is not a productive one. Members of the HOT community should be respectful when dealing with other members as well as with people outside the HOT community.</p> <p>Be careful in your word choice. We are a global community of professionals, and we conduct ourselves professionally. Be kind to others. Do not insult or put down other participants. Harassment and other exclusionary behavior aren't acceptable. This includes, but is not limited to:</p> <ul> <li> <p>Violent threats or language directed against another person.</p> </li> <li> <p>Discriminatory jokes and language.</p> </li> <li> <p>Posting sexually explicit or violent material.</p> </li> <li> <p>Posting (or threatening to post) other people's personally identifying information (\"doxing\").</p> </li> <li> <p>Personal insults, especially those using racist or sexist terms.</p> </li> <li> <p>Unwelcome sexual attention.</p> </li> <li> <p>Advocating for, or encouraging, any of the above behavior.</p> </li> <li> <p>Repeated harassment of others. In general, if someone asks you to stop, then stop.</p> </li> </ul> <p>Assume all communications are positive. Always remain polite, and assume good faith. It is surprisingly easy to misunderstand each other, be it online or in person, particularly in such a culturally diverse setting as ours. Misunderstandings are particularly easy to arise when we are in a rush, or otherwise distracted. Please ask clarifying questions before assuming that the communication was inappropriate.</p> <p>When we disagree, try to understand why. Disagreements, both social and technical, happen easily and often. It is important that we resolve such disagreements and differing views constructively. At times it can be hard to appreciate a viewpoint that contradicts your own perceptions. Instead of pushing back, try to understand where the other person is coming from, and don\u2019t be afraid to ask questions. You can be most helpful if your own replies serve to clarify, rather than to escalate an issue. Also don\u2019t forget that it can be easy to make mistakes, and allow for the possibility that the mistake may have been yours. When this happens it is better to resolve the issue together, and to learn from the experience together, than to place blame.</p> <p>Original text courtesy of the Speak Up! project.</p> <p>Further sources:</p> <ul> <li> <p>Ada Initiative: HOWTO design a code of conduct for your community</p> </li> <li> <p>Algorithm Club Code of Conduct</p> </li> <li> <p>American Red Cross GIS Team Code of Conduct</p> </li> <li> <p>Contributor Covenant \u2013 A Code of Conduct for Open Source Projects</p> </li> <li> <p>Django Code of Conduct</p> </li> <li> <p>Mozilla Community Participation Guidelines</p> </li> <li> <p>Vox Media Code of Conduct</p> </li> </ul>"},{"location":"CODE_OF_CONDUCT/#complaint-handling-process","title":"Complaint Handling Process","text":"<p>As a first measure, it is preferable to work out issues directly with the people involved, or to work with other Community Members who can help you resolve the issue. This may take several forms:</p> <ul> <li> <p>Talk with one another. Assume that communications are positive and that people are treating each other with respect. Cues about emotions are often lacking in digital communications. Many of our modes of digital communication tend towards brevity, which can be easier to interpret incorrectly as being negative.</p> </li> <li> <p>Contact a representative of the Community Working Group, which exists to support the HOT Community. Representatives are available to discuss any concerns about behaviour within the community, or ideas to promote positive behaviours. You can email them at community@hotosm.org.</p> </li> <li> <p>Contact a representative of the Governance Working Group, which drafted these recommendations and the CoC. Representatives are available to provide advice on particular scenarios, as well as on the processes around the CoC.</p> </li> <li> <p>Contact the HOT Chair of Voting Members.</p> </li> <li> <p>Contact a HOT Board Member. Board members are well-versed in the community and its management. They can offer advice on your particular situation, and know the resources of the organization that may be available to you.</p> </li> <li> <p>Contact the HOT Community Partnerships Manager.</p> </li> </ul> <p>When these informal processes fail, or when a situation warrants an immediate response by HOT, you can evoke the HOT Policy and Code of Conduct Complaint Handling Process. This process was adopted by HOT Voting Members in 2016 to provide a more formal means of enforcement for our community standards. You start it by emailing complaints@hotosm.org with a description of your complaint, your name, and the name of the offending party. All complaints will be considered confidential. The full process is described here</p>"},{"location":"CONTRIBUTING/","title":"Contributing to the Export Tool","text":""},{"location":"CONTRIBUTING/#welcome","title":"Welcome","text":"<p> First off, I'm really glad you're reading this, because we need volunteer developers to help improve the Export Tool!  We welcome and encourage contributors of all skill levels and we are committed to making sure your participation is inclusive, enjoyable and rewarding. If you have never contributed to an open source project before, we are a good place to start and will make sure you are supported every step of the way. If you have any questions, please ask!</p> <p>There are many ways to contribute to the Export Tool Project:</p>"},{"location":"CONTRIBUTING/#report-bugs-and-suggest-improvements","title":"Report bugs and suggest improvements:","text":"<p>The issue queue is the best way to get started. There are issue templates for BUGs and FEATURES that you can use, or you can create your own. Once you have submitted an issue, it will be assigned one label out of the following label categories. If you are wondering where to start, you can filter by GoodFirstIssue label.</p>"},{"location":"CONTRIBUTING/#testing","title":"Testing","text":"<p>Test a bug fix or new feature. Once an issue has been addressed and Pull Request (PR) change deployed to the Export Tool Staging site, you will be able to view and test the change on the staging site. A PR would then be made from develop to main branch, which would require two reviews. If you notice any issues while testing, please comment on the PR directly.</p>"},{"location":"CONTRIBUTING/#code-contributions","title":"Code contributions","text":"<p>Create pull requests (PRs) for changes that you think are needed. We would really appreciate your help! </p>"},{"location":"CONTRIBUTING/#documentation","title":"Documentation","text":"<p>We really welcome your input in updating the documentation pages for using the ExportTool here</p>"},{"location":"CONTRIBUTING/#thank-you","title":"Thank you!","text":"<p>Thank you very much in advance for your contributions!! Please ensure you refer to our [Code of Conduct]. If you've read the guidelines, but you are still not sure how to contribute on Github, please reach out to us via our [ HOT Tech Support page](https://hotosm.atlassian.net/servicedesk/customer/portal/4 and we will be happy to help!</p>"},{"location":"diagram/","title":"Export Tool Data Flow","text":""},{"location":"setup-development/","title":"Setup","text":""},{"location":"setup-development/#project-structure","title":"Project Structure","text":"<p>This is a guide to the source code - useful if you'd like to contribute to the Export Tool, deploy the project on your own server, or re-use parts of the project.</p> <p><code>api/</code> is a Django web application that manages creating, viewing and searching exports, storing feature selections, scheduling jobs, and user accounts via openstreetmap.org OAuth.</p> <p><code>ui/</code> is a React + ES6 frontend that communicates with the Django API. It handles localization of the user interface, the OpenLayers-based map UI, and the Tag Tree feature selection wizard. (For historical reasons, it also includes some Django views to facilitate logging in with OSM credentials.)</p>"},{"location":"setup-development/#development-prerequisites","title":"Development Prerequisites","text":"<ul> <li>Python 3.6 or later, <code>virtualenv</code>, <code>pip</code></li> <li>PostgreSQL 10+ and PostGIS</li> <li>Recommend Postgres.app which includes PostGIS.</li> <li>GDAL/OGR</li> <li>Recommend at least version 2.4 - newer versions available in <code>ubuntugis</code> PPAs or Homebrew on Mac</li> <li>RabbitMQ, a message queue</li> <li>Node.js and Yarn</li> </ul>"},{"location":"setup-development/#overpass-api","title":"Overpass API","text":"<p>The Export Tool queries an instance of the Overpass API for source data. Overpass:</p> <ul> <li>can efficiently perform spatial queries over large quantities of OSM data, including members of ways and relations.</li> <li>has built-in facilities to ingest minute diffs from OpenStreetMap.org.</li> <li>can create lossless PBF-format exports, which are necessary for some file formats such as OSMand and Garmin .IMG mobile device maps.</li> </ul> <p>Instructions on installing Overpass are available at https://github.com/drolbr/Overpass-API . Alternatively, Overpass can be run via Docker - see <code>ops/docker-overpass-api</code>.</p> <ul> <li>The export tool is configured with an Overpass URL via the environment variable <code>OVERPASS_API_URL</code>. This can be a public Overpass instance, a remote instance you manage yourself, or a local instance on your own computer. Public instances may have strict rate limits, so please use them lightly.</li> <li>To set up a local Overpass instance, start with a .pbf file. This can be the full planet .pbf from http://planet.openstreetmap.org or a region, e.g. pbfs available from http://download.geofabrik.de/ .</li> <li>Optionally, configure Overpass to update itself minutely.</li> </ul>"},{"location":"setup-development/#development-step-by-step-guide","title":"Development Step-By-Step Guide","text":""},{"location":"setup-development/#clone-the-hot-export-tool-project-from-github","title":"Clone the HOT Export Tool project from GitHub","text":"<pre><code>git clone https://github.com/hotosm/osm-export-tool.git\ncd osm-export-tool\n</code></pre>"},{"location":"setup-development/#install-python-dependencies","title":"Install Python dependencies","text":"<pre><code>virtualenv venv  # creates a new environment in venv/\nsource venv/bin/activate  # activate the virtualenv\npip install -r requirements-dev.txt\n</code></pre>"},{"location":"setup-development/#database-database-schema-and-message-queue","title":"Database, database schema, and message queue","text":"<ul> <li>PostgreSQL should be running and listening on the default port, 5432, with the shell user having administrative permissions.</li> <li>RabbitMQ should be running and listening on the default port, 5672.</li> </ul> <p>Create and populate a PostgreSQL database named <code>exports</code>:</p> <pre><code>createdb exports\npsql exports -c \"create extension postgis;\"\npsql exports -c \"create extension hstore;\"\npython manage.py migrate\n</code></pre>"},{"location":"setup-development/#compile-the-front-end-application","title":"Compile the front-end application","text":"<pre><code>cd ui/\nyarn install\nyarn run dist # for production\nyarn start  # will watch for changes and re-compile as necessary\n</code></pre>"},{"location":"setup-development/#set-required-environment-variables-and-start-the-server","title":"Set required environment variables and start the server","text":"<pre><code>DEBUG=True python manage.py runserver\n\n# in a different shell\nDEBUG=True DJANGO_SETTINGS_MODULE=core.settings.project dramatiq tasks.task_runners -p 1\n</code></pre> <p><code>direnv</code> is a useful tool for managing environment variables using a <code>.env</code> file.</p> <p>\u200b You should now be able to navigate to http://localhost:8000 and log in via OSM. With <code>DJANGO_ENV</code> set to <code>development</code>, emails will not be sent, but the email body will appear in your console from <code>runserver</code>. Navigate to this link to verify your account. Creating an export will use the public Overpass API. Successful job creations will write the exports to the filesystem to the <code>export_downloads</code> directory, a sibling of the <code>osm-export-tool2</code> checkout - since the NGINX file server is not running in development, download links won't be valid.</p>"},{"location":"setup-development/#other-dependencies","title":"Other dependencies","text":"<p>See <code>core/settings/project.py</code> for environment variables to configure other optional runtime dependencies.</p>"},{"location":"setup-development/#garmin-img","title":"Garmin .IMG","text":"<p>Creating .IMG files require the <code>mkgmap</code> and <code>splitter</code> tools.</p> <p>http://www.mkgmap.org.uk/download/mkgmap.html</p> <p>http://www.mkgmap.org.uk/download/splitter.html</p>"},{"location":"setup-development/#osmand-obf","title":"OSMAnd .OBF","text":"<p>For details and download links to the OSMAnd Map Creator utilities, see http://wiki.openstreetmap.org/wiki/OsmAndMapCreator</p>"},{"location":"setup-development/#list-of-environment-variables","title":"List of environment variables","text":"<p>Most of these environment variables have reasonable default settings.</p> <ul> <li><code>EXPORT_STAGING_ROOT</code> path to a directory for staging export jobs</li> <li><code>EXPORT_DOWNLOAD_ROOT</code>'path to a directory for storing export downloads</li> <li><code>EXPORT_MEDIA_ROOT</code> map this url in your webserver to <code>EXPORT_DOWNLOAD_ROOT</code> to serve the exported files</li> <li><code>OSMAND_MAP_CREATOR_DIR</code> path to the directory where OsmAndMapCreator is installed</li> <li><code>GARMIN_CONFIG</code>, <code>GARMIN_MKGMAP</code> absolute paths to garmin JARs</li> <li> <p><code>OVERPASS_API_URL</code> url of Overpass api endpoint</p> </li> <li> <p><code>RAW_DATA_API_URL</code> url of Raw data api endpoint</p> </li> <li> <p><code>DATABASE_URL</code> Database URL. Defaults to <code>postgres:///exports</code></p> </li> <li><code>DEBUG</code> Whether to enable debug mode. Defaults to <code>False</code> (production).</li> <li><code>DJANGO_ENV</code> Django environment. Set to <code>development</code> to enable development tools and email logging to the console.</li> <li><code>EMAIL_HOST_USER</code> SMTP username.</li> <li><code>EMAIL_HOST_PASSWORD</code> SMTP password.</li> <li><code>EMAIL_USE_TLS</code> Whether to use TLS when sending mail. Optional.</li> <li><code>HOSTNAME</code> Publicly-addressable hostname. Defaults to <code>export.hotosm.org</code></li> <li><code>USE_X_FORWARDED_HOST</code> - Whether Django is running behind a proxy. Defaults to <code>False</code></li> </ul>"},{"location":"setup-development/#using-the-transifex-service","title":"Using the Transifex service","text":"<p>(This section is TBD, as we're currently figuring out workflows for FormatJS JSON strings used by <code>react-intl</code>.)</p> <p>To work with Transifex, you need to create <code>~/.transifexrc</code>, and modify its access privileges:</p> <pre><code>chmod 600 ~/.transifexrc\n</code></pre> <p>Example <code>.transifexrc</code> file:</p> <pre><code>[https://www.transifex.com]\nhostname = https://www.transifex.com\npassword = my_super_password\ntoken =\nusername = my_transifex_username\n</code></pre>"},{"location":"setup-development/#managing-source-files","title":"Managing source files","text":"<p>To update source language (English) for Django templates run:</p> <pre><code>python manage.py makemessages -l en\n</code></pre> <p>To update the source language for JavaScript files run:</p> <pre><code>python manage.py makemessages -d djangojs -l en\n</code></pre> <p>then, push the new source files to the Transifex service, it will overwrite the current source files</p> <pre><code>tx push -s\n</code></pre>"},{"location":"setup-development/#pulling-the-latest-changes-from-transifex","title":"Pulling the latest changes from Transifex","text":"<p>When adding a new language, its resource file does not exist in the project, but it's ok as it will be automatically created when pulling new translations from the service. To add a local mapping:</p> <pre><code>tx set -r osm-export-tool2.master -l hr locales/hr/LC_MESSAGES/django.po\n</code></pre> <p>or for JavaScript files:</p> <pre><code>tx set -r osm-export-tool2.djangojs -l hr locales/hr/LC_MESSAGES/djangojs.po\n</code></pre> <p>Once there are some translation updates, pull the latest changes for mapped resources.</p> <p>For a specific language(s):</p> <pre><code>tx pull -l fr,hr\n</code></pre> <p>For all languages:</p> <pre><code>tx pull\n</code></pre> <p>Finally, compile language files:</p> <pre><code>python manage.py compilemessages\n</code></pre>"},{"location":"setup-development/#ui-translations","title":"UI Translations","text":"<p>To fetch updated translations for the JavaScript front-end, run:</p> <pre><code>cd ui/\nyarn run tx:pull\n</code></pre> <p>To push updated strings to Transifex, run:</p> <pre><code>cd ui/\n\n# build the app (to extract new strings)\nyarn run pack\n\nyarn run tx:push\n</code></pre> <p>If / when UI translations pass the 5% complete threshold (defined in <code>ui/.tx/config</code> as <code>minimum_perc</code>), new JSON files will appear in <code>ui/app/i18n/locales</code>. To enable these translations for use, add <code>react-intl</code> locale data to <code>ui/app/app.js</code> (for date/number formatting) and add options to <code>ui/app/components/LocaleSelector.js</code>.</p>"}]}